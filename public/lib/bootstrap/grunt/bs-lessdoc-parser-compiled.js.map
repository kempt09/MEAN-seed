{"version":3,"sources":["bs-lessdoc-parser.js"],"names":[],"mappings":"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","file":"bs-lessdoc-parser-compiled.js","sourcesContent":["/*!\n * Bootstrap Grunt task for parsing Less docstrings\n * http://getbootstrap.com\n * Copyright 2014-2015 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n */\n\n'use strict';\n\nvar Markdown = require('markdown-it');\n\nfunction markdown2html(markdownString) {\n  var md = new Markdown();\n\n  // the slice removes the <p>...</p> wrapper output by Markdown processor\n  return md.render(markdownString.trim()).slice(3, -5);\n}\n\n\n/*\nMini-language:\n  //== This is a normal heading, which starts a section. Sections group variables together.\n  //## Optional description for the heading\n\n  //=== This is a subheading.\n\n  //** Optional description for the following variable. You **can** use Markdown in descriptions to discuss `<html>` stuff.\n  @foo: #fff;\n\n  //-- This is a heading for a section whose variables shouldn't be customizable\n\n  All other lines are ignored completely.\n*/\n\n\nvar CUSTOMIZABLE_HEADING = /^[/]{2}={2}(.*)$/;\nvar UNCUSTOMIZABLE_HEADING = /^[/]{2}-{2}(.*)$/;\nvar SUBSECTION_HEADING = /^[/]{2}={3}(.*)$/;\nvar SECTION_DOCSTRING = /^[/]{2}#{2}(.+)$/;\nvar VAR_ASSIGNMENT = /^(@[a-zA-Z0-9_-]+):[ ]*([^ ;][^;]*);[ ]*$/;\nvar VAR_DOCSTRING = /^[/]{2}[*]{2}(.+)$/;\n\nfunction Section(heading, customizable) {\n  this.heading = heading.trim();\n  this.id = this.heading.replace(/\\s+/g, '-').toLowerCase();\n  this.customizable = customizable;\n  this.docstring = null;\n  this.subsections = [];\n}\n\nSection.prototype.addSubSection = function (subsection) {\n  this.subsections.push(subsection);\n};\n\nfunction SubSection(heading) {\n  this.heading = heading.trim();\n  this.id = this.heading.replace(/\\s+/g, '-').toLowerCase();\n  this.variables = [];\n}\n\nSubSection.prototype.addVar = function (variable) {\n  this.variables.push(variable);\n};\n\nfunction VarDocstring(markdownString) {\n  this.html = markdown2html(markdownString);\n}\n\nfunction SectionDocstring(markdownString) {\n  this.html = markdown2html(markdownString);\n}\n\nfunction Variable(name, defaultValue) {\n  this.name = name;\n  this.defaultValue = defaultValue;\n  this.docstring = null;\n}\n\nfunction Tokenizer(fileContent) {\n  this._lines = fileContent.split('\\n');\n  this._next = undefined;\n}\n\nTokenizer.prototype.unshift = function (token) {\n  if (this._next !== undefined) {\n    throw new Error('Attempted to unshift twice!');\n  }\n  this._next = token;\n};\n\nTokenizer.prototype._shift = function () {\n  // returning null signals EOF\n  // returning undefined means the line was ignored\n  if (this._next !== undefined) {\n    var result = this._next;\n    this._next = undefined;\n    return result;\n  }\n  if (this._lines.length <= 0) {\n    return null;\n  }\n  var line = this._lines.shift();\n  var match = null;\n  match = SUBSECTION_HEADING.exec(line);\n  if (match !== null) {\n    return new SubSection(match[1]);\n  }\n  match = CUSTOMIZABLE_HEADING.exec(line);\n  if (match !== null) {\n    return new Section(match[1], true);\n  }\n  match = UNCUSTOMIZABLE_HEADING.exec(line);\n  if (match !== null) {\n    return new Section(match[1], false);\n  }\n  match = SECTION_DOCSTRING.exec(line);\n  if (match !== null) {\n    return new SectionDocstring(match[1]);\n  }\n  match = VAR_DOCSTRING.exec(line);\n  if (match !== null) {\n    return new VarDocstring(match[1]);\n  }\n  var commentStart = line.lastIndexOf('//');\n  var varLine = commentStart === -1 ? line : line.slice(0, commentStart);\n  match = VAR_ASSIGNMENT.exec(varLine);\n  if (match !== null) {\n    return new Variable(match[1], match[2]);\n  }\n  return undefined;\n};\n\nTokenizer.prototype.shift = function () {\n  while (true) {\n    var result = this._shift();\n    if (result === undefined) {\n      continue;\n    }\n    return result;\n  }\n};\n\nfunction Parser(fileContent) {\n  this._tokenizer = new Tokenizer(fileContent);\n}\n\nParser.prototype.parseFile = function () {\n  var sections = [];\n  while (true) {\n    var section = this.parseSection();\n    if (section === null) {\n      if (this._tokenizer.shift() !== null) {\n        throw new Error('Unexpected unparsed section of file remains!');\n      }\n      return sections;\n    }\n    sections.push(section);\n  }\n};\n\nParser.prototype.parseSection = function () {\n  var section = this._tokenizer.shift();\n  if (section === null) {\n    return null;\n  }\n  if (!(section instanceof Section)) {\n    throw new Error('Expected section heading; got: ' + JSON.stringify(section));\n  }\n  var docstring = this._tokenizer.shift();\n  if (docstring instanceof SectionDocstring) {\n    section.docstring = docstring;\n  } else {\n    this._tokenizer.unshift(docstring);\n  }\n  this.parseSubSections(section);\n\n  return section;\n};\n\nParser.prototype.parseSubSections = function (section) {\n  while (true) {\n    var subsection = this.parseSubSection();\n    if (subsection === null) {\n      if (section.subsections.length === 0) {\n        // Presume an implicit initial subsection\n        subsection = new SubSection('');\n        this.parseVars(subsection);\n      } else {\n        break;\n      }\n    }\n    section.addSubSection(subsection);\n  }\n\n  if (section.subsections.length === 1 && !section.subsections[0].heading && section.subsections[0].variables.length === 0) {\n    // Ignore lone empty implicit subsection\n    section.subsections = [];\n  }\n};\n\nParser.prototype.parseSubSection = function () {\n  var subsection = this._tokenizer.shift();\n  if (subsection instanceof SubSection) {\n    this.parseVars(subsection);\n    return subsection;\n  }\n  this._tokenizer.unshift(subsection);\n  return null;\n};\n\nParser.prototype.parseVars = function (subsection) {\n  while (true) {\n    var variable = this.parseVar();\n    if (variable === null) {\n      return;\n    }\n    subsection.addVar(variable);\n  }\n};\n\nParser.prototype.parseVar = function () {\n  var docstring = this._tokenizer.shift();\n  if (!(docstring instanceof VarDocstring)) {\n    this._tokenizer.unshift(docstring);\n    docstring = null;\n  }\n  var variable = this._tokenizer.shift();\n  if (variable instanceof Variable) {\n    variable.docstring = docstring;\n    return variable;\n  }\n  this._tokenizer.unshift(variable);\n  return null;\n};\n\n\nmodule.exports = Parser;\n"]}